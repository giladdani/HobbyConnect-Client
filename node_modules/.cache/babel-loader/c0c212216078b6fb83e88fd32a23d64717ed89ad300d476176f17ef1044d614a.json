{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\danin\\\\Desktop\\\\JS The Social Network\\\\client\\\\src\\\\components\\\\Home.js\";\nimport React from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nclass HomePage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      navbar_mode: undefined,\n      user_token: extract_token_from_cookie(),\n      posts: [],\n      messages: [],\n      user: undefined\n    };\n    this.posts_loaded = this.posts_loaded.bind(this);\n  }\n  async componentDidMount() {\n    const user_permissions = await verify_page_access();\n    if (user_permissions.includes(\"admin\")) {\n      this.setState({\n        navbar_mode: \"full\"\n      });\n    } else if (user_permissions.includes(\"user\")) {\n      this.setState({\n        navbar_mode: \"normal\"\n      });\n    }\n    const user = await this.get_user_details();\n    this.setState({\n      user: user\n    });\n    const messages = await this.fetch_all_messages();\n    const my_messages = messages.filter(message => message.receiver_id == this.state.user.id || message.sender_id == this.state.user.id).reverse();\n    this.setState({\n      messages: my_messages\n    });\n  }\n  posts_loaded(posts) {\n    this.setState({\n      posts: posts\n    });\n  }\n  async fetch_all_messages() {\n    const response = await fetch('/api/messages', {\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json',\n        'authorization': this.state.user_token\n      },\n      method: 'GET'\n    });\n    if (response.status != 200) throw new Error('Error while fetching messages');\n    const data = await response.json();\n    return data;\n  }\n  async get_user_details() {\n    const response = await fetch('/api/users/about', {\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json',\n        'authorization': this.state.user_token\n      },\n      method: 'GET'\n    });\n    if (response.status != 200) throw new Error('Error while fetching user details');\n    const data = await response.json();\n    return data;\n  }\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(NavBar, {\n        mode: this.state.navbar_mode\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"center_elem\",\n        children: \"Home Page\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Indicator, {\n        mode: \"posts\",\n        items: this.state.posts,\n        user_token: this.state.user_token\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Indicator, {\n        mode: \"messages\",\n        items: this.state.messages,\n        user_token: this.state.user_token,\n        user: this.state.user\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"full_width\",\n        children: /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"center_elem\",\n                children: \"Your last post\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 77,\n                columnNumber: 9\n              }, this), /*#__PURE__*/_jsxDEV(MyLastPost, {\n                user_token: this.state.user_token\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 78,\n                columnNumber: 9\n              }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"center_elem\",\n                children: \"Latest 10 posts\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 79,\n                columnNumber: 9\n              }, this), /*#__PURE__*/_jsxDEV(RecentPostsList, {\n                user_token: this.state.user_token,\n                max: \"10\",\n                notify_posts_loaded: this.posts_loaded\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 80,\n                columnNumber: 9\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 76,\n              columnNumber: 8\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"center_elem\",\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                children: \"Create a post\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 83,\n                columnNumber: 9\n              }, this), /*#__PURE__*/_jsxDEV(CreatePost, {\n                user_token: this.state.user_token\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 84,\n                columnNumber: 9\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 82,\n              columnNumber: 8\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 75,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 6\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 4\n    }, this);\n  }\n}\nexport default HomePage;","map":{"version":3,"names":["React","HomePage","Component","constructor","props","state","navbar_mode","undefined","user_token","extract_token_from_cookie","posts","messages","user","posts_loaded","bind","componentDidMount","user_permissions","verify_page_access","includes","setState","get_user_details","fetch_all_messages","my_messages","filter","message","receiver_id","id","sender_id","reverse","response","fetch","headers","method","status","Error","data","json","render"],"sources":["C:/Users/danin/Desktop/JS The Social Network/client/src/components/Home.js"],"sourcesContent":["import React from 'react';\r\n\r\nclass HomePage extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n            navbar_mode: undefined,\r\n\t\t\tuser_token: extract_token_from_cookie(),\r\n\t\t\tposts: [],\r\n\t\t\tmessages: [],\r\n\t\t\tuser: undefined\r\n        }\r\n\t\tthis.posts_loaded = this.posts_loaded.bind(this);\r\n\t}\r\n\r\n\tasync componentDidMount() {\r\n\t\tconst user_permissions = await verify_page_access();\r\n\t\tif(user_permissions.includes(\"admin\")){\r\n\t\t\tthis.setState({navbar_mode: \"full\"});\r\n\t\t}\r\n\t\telse if(user_permissions.includes(\"user\")){\r\n\t\t\tthis.setState({navbar_mode: \"normal\"});\r\n\t\t}\r\n\r\n\t\tconst user = await this.get_user_details();\r\n\t\tthis.setState({user: user});\r\n\t\tconst messages = await this.fetch_all_messages();\r\n\t\tconst my_messages = messages.filter(message => (message.receiver_id == this.state.user.id || message.sender_id == this.state.user.id)).reverse();\r\n\t\tthis.setState({messages: my_messages});\r\n\t}\r\n\r\n\tposts_loaded(posts){\r\n\t\tthis.setState({posts: posts});\r\n\t}\r\n\r\n\tasync fetch_all_messages() {\r\n\t\tconst response = await fetch('/api/messages', \r\n\t\t{\r\n\t\t\theaders: {\r\n\t\t\t\t'Accept': 'application/json',\r\n\t\t\t\t'Content-Type': 'application/json',\r\n                'authorization': this.state.user_token\r\n\t\t\t},\r\n\t\t\tmethod: 'GET'\r\n\t\t});\r\n\t\tif (response.status != 200) throw new Error('Error while fetching messages');\r\n\t\tconst data = await response.json();\r\n\t\treturn data;\r\n\t}\r\n\r\n\tasync get_user_details() {\r\n\t\tconst response = await fetch('/api/users/about', \r\n\t\t{\r\n\t\t\theaders: {\r\n\t\t\t\t'Accept': 'application/json',\r\n\t\t\t\t'Content-Type': 'application/json',\r\n                'authorization': this.state.user_token\r\n\t\t\t},\r\n\t\t\tmethod: 'GET'\r\n\t\t});\r\n\t\tif (response.status != 200) throw new Error('Error while fetching user details');\r\n\t\tconst data = await response.json();\r\n\t\treturn data;\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn(\r\n\t\t\t<div>\r\n\t\t\t\t<NavBar mode={this.state.navbar_mode}></NavBar>\r\n\t\t\t\t<h1 className=\"center_elem\">Home Page</h1>\r\n\t\t\t\t<Indicator mode=\"posts\" items={this.state.posts} user_token={this.state.user_token}></Indicator>\r\n\t\t\t\t<Indicator mode=\"messages\" items={this.state.messages} user_token={this.state.user_token} user={this.state.user}></Indicator>\r\n\t\t\t\t<table className=\"full_width\">\r\n\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t<h2 className=\"center_elem\">Your last post</h2>\r\n\t\t\t\t\t\t\t\t<MyLastPost user_token={this.state.user_token}></MyLastPost>\r\n\t\t\t\t\t\t\t\t<h2 className=\"center_elem\">Latest 10 posts</h2>\r\n\t\t\t\t\t\t\t\t<RecentPostsList user_token={this.state.user_token} max=\"10\" notify_posts_loaded={this.posts_loaded}></RecentPostsList>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t<td className=\"center_elem\">\r\n\t\t\t\t\t\t\t\t<h2>Create a post</h2>\r\n\t\t\t\t\t\t\t\t<CreatePost user_token={this.state.user_token}></CreatePost>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t</tbody>\r\n\t\t\t\t</table>\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default HomePage;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}